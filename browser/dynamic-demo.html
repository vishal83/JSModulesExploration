<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÑ Dynamic Imports Demo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .nav {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .nav a {
            display: inline-block;
            margin: 0 10px;
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s;
            backdrop-filter: blur(5px);
        }
        
        .nav a:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
        }
        
        .demo-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s;
        }
        
        .demo-card:hover {
            transform: translateY(-5px);
        }
        
        .demo-card h2 {
            color: #FFD700;
            margin-bottom: 15px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4CAF50;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .output {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 13px;
            line-height: 1.5;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .output.success {
            border-left: 4px solid #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }
        
        .output.loading {
            border-left: 4px solid #FF9800;
            background: rgba(255, 152, 0, 0.1);
        }
        
        .output.error {
            border-left: 4px solid #F44336;
            background: rgba(244, 67, 54, 0.1);
        }
        
        button {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }
        
        button:hover {
            background: linear-gradient(135deg, #45a049, #4CAF50);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        button.danger {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }
        
        button.danger:hover {
            background: linear-gradient(135deg, #d32f2f, #b71c1c);
        }
        
        button.secondary {
            background: linear-gradient(135deg, #6c757d, #5a6268);
        }
        
        button.secondary:hover {
            background: linear-gradient(135deg, #5a6268, #495057);
        }
        
        .info-panel {
            background: rgba(33, 150, 243, 0.2);
            border-left: 4px solid #2196F3;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .info-panel h3 {
            margin-bottom: 10px;
            color: #FFD700;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            margin: 8px 0;
            padding-left: 25px;
            position: relative;
        }
        
        .feature-list li::before {
            content: '‚ú®';
            position: absolute;
            left: 0;
        }
        
        .spinner {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top: 2px solid #FFD700;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîÑ Dynamic Imports Demo</h1>
            <p>Explore runtime module loading, code splitting, and lazy loading in the browser</p>
        </div>
        
        <div class="nav">
            <a href="/">üè† Home</a>
            <a href="/esm-demo">üì¶ ES Modules</a>
            <a href="/loading-demo">‚ö° Loading Demo</a>
            <a href="https://github.com/vishal83/JSModulesExploration" target="_blank">üìö GitHub</a>
        </div>
        
        <div class="demo-grid">
            <div class="demo-card">
                <h2>
                    <div class="status-indicator"></div>
                    Basic Dynamic Import
                </h2>
                <p>Load modules on-demand using the dynamic import() function</p>
                
                <button onclick="basicDynamicImport()">Load Math Module</button>
                <button onclick="clearOutput('basic')" class="secondary">Clear</button>
                
                <div id="basic-output" class="output">
Click "Load Math Module" to see dynamic import in action!
                </div>
                
                <div class="info-panel">
                    <h3>üí° What happens:</h3>
                    <ul class="feature-list">
                        <li>Module loaded at runtime</li>
                        <li>Returns a Promise</li>
                        <li>Same module singleton pattern</li>
                        <li>Perfect for code splitting</li>
                    </ul>
                </div>
            </div>
            
            <div class="demo-card">
                <h2>
                    <div class="status-indicator"></div>
                    Conditional Loading
                </h2>
                <p>Load modules based on conditions, user interactions, or feature flags</p>
                
                <button onclick="conditionalImport('math')">Math Features</button>
                <button onclick="conditionalImport('user')">User Features</button>
                <button onclick="conditionalImport('config')">Config Features</button>
                <button onclick="clearOutput('conditional')" class="secondary">Clear</button>
                
                <div id="conditional-output" class="output">
Choose a feature set to load conditionally!
                </div>
                
                <div class="info-panel">
                    <h3>üéØ Use Cases:</h3>
                    <ul class="feature-list">
                        <li>Feature flags</li>
                        <li>User role-based loading</li>
                        <li>Environment-specific code</li>
                        <li>Progressive enhancement</li>
                    </ul>
                </div>
            </div>
            
            <div class="demo-card">
                <h2>
                    <div class="status-indicator"></div>
                    Lazy Loading Simulation
                </h2>
                <p>Simulate lazy loading components and features as needed</p>
                
                <button onclick="lazyLoadComponent('calculator')">Load Calculator</button>
                <button onclick="lazyLoadComponent('userManager')">Load User Manager</button>
                <button onclick="lazyLoadComponent('dashboard')">Load Dashboard</button>
                <button onclick="clearOutput('lazy')" class="secondary">Clear</button>
                
                <div id="lazy-output" class="output">
Click any button to simulate lazy loading a component!
                </div>
                
                <div class="info-panel">
                    <h3>‚ö° Benefits:</h3>
                    <ul class="feature-list">
                        <li>Faster initial load times</li>
                        <li>Reduced bundle size</li>
                        <li>Better performance</li>
                        <li>On-demand functionality</li>
                    </ul>
                </div>
            </div>
            
            <div class="demo-card">
                <h2>
                    <div class="status-indicator"></div>
                    Error Handling
                </h2>
                <p>Handle failed dynamic imports gracefully</p>
                
                <button onclick="testSuccessfulImport()">Test Success</button>
                <button onclick="testFailedImport()">Test Failure</button>
                <button onclick="testWithFallback()">Test with Fallback</button>
                <button onclick="clearOutput('error')" class="secondary">Clear</button>
                
                <div id="error-output" class="output">
Test different scenarios for dynamic import error handling!
                </div>
                
                <div class="info-panel">
                    <h3>üõ°Ô∏è Error Handling:</h3>
                    <ul class="feature-list">
                        <li>Try-catch blocks</li>
                        <li>Fallback strategies</li>
                        <li>User feedback</li>
                        <li>Retry mechanisms</li>
                    </ul>
                </div>
            </div>
            
            <div class="demo-card">
                <h2>
                    <div class="status-indicator"></div>
                    Performance Analysis
                </h2>
                <p>Analyze the performance impact of dynamic imports</p>
                
                <button onclick="performanceTest()">Run Performance Test</button>
                <button onclick="networkAnalysis()">Network Analysis</button>
                <button onclick="clearOutput('performance')" class="secondary">Clear</button>
                
                <div id="performance-output" class="output">
Click "Run Performance Test" to analyze dynamic import performance!
                </div>
                
                <div class="info-panel">
                    <h3>üìä Metrics:</h3>
                    <ul class="feature-list">
                        <li>Load time comparison</li>
                        <li>Network requests</li>
                        <li>Memory usage</li>
                        <li>Cache effectiveness</li>
                    </ul>
                </div>
            </div>
            
            <div class="demo-card">
                <h2>
                    <div class="status-indicator"></div>
                    Advanced Patterns
                </h2>
                <p>Explore advanced dynamic import patterns and techniques</p>
                
                <button onclick="moduleFactory()">Module Factory</button>
                <button onclick="parallelImports()">Parallel Imports</button>
                <button onclick="moduleProxy()">Module Proxy</button>
                <button onclick="clearOutput('advanced')" class="secondary">Clear</button>
                
                <div id="advanced-output" class="output">
Explore advanced dynamic import patterns!
                </div>
                
                <div class="info-panel">
                    <h3>üöÄ Advanced:</h3>
                    <ul class="feature-list">
                        <li>Module factories</li>
                        <li>Parallel loading</li>
                        <li>Dynamic proxies</li>
                        <li>Module orchestration</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        console.log('üîÑ Dynamic Imports Demo initialized');
        
        // Utility functions
        function updateOutput(id, content, type = 'success') {
            const element = document.getElementById(id + '-output');
            element.textContent = content;
            element.className = `output ${type}`;
            element.scrollTop = element.scrollHeight;
        }
        
        function showLoading(id, message = 'Loading...') {
            updateOutput(id, `üîÑ ${message}`, 'loading');
        }
        
        // Basic dynamic import
        window.basicDynamicImport = async function() {
            showLoading('basic', 'Loading math module dynamically...');
            
            try {
                console.time('Dynamic Import');
                
                // Dynamic import returns a Promise
                const mathModule = await import('/esm/math-utils.js');
                
                console.timeEnd('Dynamic Import');
                
                // Use the imported module
                const result1 = mathModule.add(25, 15);
                const result2 = mathModule.multiply(8, 7);
                const calc = new mathModule.Calculator('Dynamic Calculator');
                const calcResult = calc.calculate('divide', 100, 4);
                
                updateOutput('basic', `‚úÖ Math module loaded dynamically!

üßÆ Function Results:
  add(25, 15) = ${result1}
  multiply(8, 7) = ${result2}

üì± Calculator Instance:
  Name: ${calc.name}
  100 √∑ 4 = ${calcResult}

üì¶ Available exports:
  ${Object.keys(mathModule).join(', ')}

‚è±Ô∏è Load Performance:
  Check console for timing details!
  
üí° Key Points:
‚Ä¢ Module loaded at runtime via import()
‚Ä¢ Returns a Promise that resolves to module object
‚Ä¢ Same singleton behavior as static imports
‚Ä¢ Perfect for code splitting and lazy loading`, 'success');
                
            } catch (error) {
                updateOutput('basic', `‚ùå Dynamic import failed: ${error.message}`, 'error');
            }
        };
        
        // Conditional loading
        window.conditionalImport = async function(feature) {
            showLoading('conditional', `Loading ${feature} features...`);
            
            try {
                let result = `üéØ Conditional Loading: ${feature}\n\n`;
                
                switch (feature) {
                    case 'math':
                        if (typeof window.mathFeatures === 'undefined') {
                            const mathModule = await import('/esm/math-utils.js');
                            window.mathFeatures = mathModule;
                            result += 'üì¶ Math module loaded for first time\n';
                        } else {
                            result += '‚ôªÔ∏è Math module already cached\n';
                        }
                        
                        result += `üßÆ Available functions:\n`;
                        result += `  ‚Ä¢ add(10, 5) = ${window.mathFeatures.add(10, 5)}\n`;
                        result += `  ‚Ä¢ PI = ${window.mathFeatures.PI}\n`;
                        break;
                        
                    case 'user':
                        if (typeof window.userFeatures === 'undefined') {
                            const userModule = await import('/esm/user-service.js');
                            window.userFeatures = userModule;
                            result += 'üì¶ User module loaded for first time\n';
                        } else {
                            result += '‚ôªÔ∏è User module already cached\n';
                        }
                        
                        const userService = new window.userFeatures.default();
                        result += `üë• User management:\n`;
                        result += `  ‚Ä¢ Total users: ${userService.getAllUsers().length}\n`;
                        result += `  ‚Ä¢ Available roles: ${Object.keys(window.userFeatures.ROLES).join(', ')}\n`;
                        break;
                        
                    case 'config':
                        if (typeof window.configFeatures === 'undefined') {
                            const configModule = await import('/esm/config.js');
                            window.configFeatures = configModule;
                            result += 'üì¶ Config module loaded for first time\n';
                        } else {
                            result += '‚ôªÔ∏è Config module already cached\n';
                        }
                        
                        result += `‚öôÔ∏è Configuration:\n`;
                        result += `  ‚Ä¢ Environment: ${window.configFeatures.config.environment}\n`;
                        result += `  ‚Ä¢ Version: ${window.configFeatures.getVersion()}\n`;
                        result += `  ‚Ä¢ Development: ${window.configFeatures.isDevelopment()}\n`;
                        break;
                }
                
                result += `\nüí° This demonstrates:\n`;
                result += `‚Ä¢ Loading modules only when needed\n`;
                result += `‚Ä¢ Caching prevents duplicate loads\n`;
                result += `‚Ä¢ Feature-based code organization\n`;
                result += `‚Ä¢ Reduced initial bundle size`;
                
                updateOutput('conditional', result, 'success');
                
            } catch (error) {
                updateOutput('conditional', `‚ùå Conditional import failed: ${error.message}`, 'error');
            }
        };
        
        // Lazy loading simulation
        window.lazyLoadComponent = async function(component) {
            showLoading('lazy', `Lazy loading ${component} component...`);
            
            // Simulate different loading times
            const loadTime = Math.random() * 1000 + 500;
            
            setTimeout(async () => {
                try {
                    let result = `üîÑ Lazy Loading Simulation: ${component}\n\n`;
                    result += `‚è±Ô∏è Simulated load time: ${loadTime.toFixed(0)}ms\n\n`;
                    
                    switch (component) {
                        case 'calculator':
                            const mathModule = await import('/esm/math-utils.js');
                            const calc = new mathModule.Calculator('Lazy Calculator');
                            
                            result += `üî¢ Calculator Component Loaded!\n`;
                            result += `  ‚Ä¢ Component: ${calc.name}\n`;
                            result += `  ‚Ä¢ Demo calculation: 50 √ó 2 = ${calc.calculate('multiply', 50, 2)}\n`;
                            result += `  ‚Ä¢ Available operations: add, subtract, multiply, divide\n`;
                            break;
                            
                        case 'userManager':
                            const userModule = await import('/esm/user-service.js');
                            const userManager = new userModule.default();
                            
                            result += `üë• User Manager Component Loaded!\n`;
                            result += `  ‚Ä¢ Current users: ${userManager.getAllUsers().length}\n`;
                            result += `  ‚Ä¢ Roles system: ${Object.values(userModule.ROLES).join(', ')}\n`;
                            result += `  ‚Ä¢ Features: CRUD operations, validation, formatting\n`;
                            break;
                            
                        case 'dashboard':
                            const [mathMod, userMod, configMod] = await Promise.all([
                                import('/esm/math-utils.js'),
                                import('/esm/user-service.js'), 
                                import('/esm/config.js')
                            ]);
                            
                            result += `üìä Dashboard Component Loaded!\n`;
                            result += `  ‚Ä¢ Math utilities: ‚úÖ\n`;
                            result += `  ‚Ä¢ User management: ‚úÖ\n`;
                            result += `  ‚Ä¢ Configuration: ‚úÖ\n`;
                            result += `  ‚Ä¢ Environment: ${configMod.config.environment}\n`;
                            result += `  ‚Ä¢ Total system users: ${new userMod.default().getAllUsers().length}\n`;
                            break;
                    }
                    
                    result += `\nüöÄ Benefits achieved:\n`;
                    result += `‚Ä¢ Component loaded only when requested\n`;
                    result += `‚Ä¢ Initial page load was faster\n`;
                    result += `‚Ä¢ Memory efficient (no unused code)\n`;
                    result += `‚Ä¢ Better user experience with progressive loading`;
                    
                    updateOutput('lazy', result, 'success');
                    
                } catch (error) {
                    updateOutput('lazy', `‚ùå Lazy loading failed: ${error.message}`, 'error');
                }
            }, loadTime);
        };
        
        // Error handling tests
        window.testSuccessfulImport = async function() {
            showLoading('error', 'Testing successful dynamic import...');
            
            try {
                const module = await import('/esm/math-utils.js');
                updateOutput('error', `‚úÖ Successful Import Test

üì¶ Module loaded: math-utils.js
üéØ Test result: add(1, 1) = ${module.add(1, 1)}
‚ö° Status: Import successful
üìä Exports available: ${Object.keys(module).length}

üí° This shows:
‚Ä¢ Dynamic imports working correctly
‚Ä¢ Module resolution successful
‚Ä¢ All exports accessible
‚Ä¢ Error handling not triggered`, 'success');
                
            } catch (error) {
                updateOutput('error', `‚ùå Unexpected error: ${error.message}`, 'error');
            }
        };
        
        window.testFailedImport = async function() {
            showLoading('error', 'Testing failed dynamic import...');
            
            try {
                // Try to import a non-existent module
                await import('/nonexistent/module.js');
                updateOutput('error', '‚ùå This should not appear - import should have failed!', 'error');
                
            } catch (error) {
                updateOutput('error', `‚úÖ Error Handling Test Successful

‚ùå Import failed as expected: /nonexistent/module.js
üîç Error type: ${error.name}
üìù Error message: ${error.message}
‚ö° Status: Caught and handled properly

üí° This demonstrates:
‚Ä¢ Proper error handling with try-catch
‚Ä¢ Network 404 errors are caught
‚Ä¢ User can be informed gracefully
‚Ä¢ Application continues running`, 'success');
            }
        };
        
        window.testWithFallback = async function() {
            showLoading('error', 'Testing import with fallback strategy...');
            
            try {
                let module;
                let strategy = '';
                
                try {
                    // Try to import preferred module (that doesn't exist)
                    module = await import('/esm/advanced-math.js');
                    strategy = 'Primary module loaded';
                } catch (primaryError) {
                    try {
                        // Fallback to basic module
                        module = await import('/esm/math-utils.js');
                        strategy = 'Fallback module loaded';
                    } catch (fallbackError) {
                        // Last resort: create minimal functionality
                        module = {
                            add: (a, b) => a + b,
                            multiply: (a, b) => a * b,
                            fallback: true
                        };
                        strategy = 'Emergency fallback created';
                    }
                }
                
                updateOutput('error', `‚úÖ Fallback Strategy Test

üì¶ Result: ${strategy}
üßÆ Test calculation: 3 √ó 4 = ${module.multiply(3, 4)}
‚ö° Available functions: ${Object.keys(module).join(', ')}

üîÑ Fallback Chain:
1. Try advanced-math.js ‚Üí ‚ùå Failed (expected)
2. Try math-utils.js ‚Üí ‚úÖ Success!
3. Emergency fallback ‚Üí (not needed)

üí° This shows:
‚Ä¢ Graceful degradation strategies
‚Ä¢ Multiple fallback levels
‚Ä¢ User experience preserved
‚Ä¢ Application remains functional`, 'success');
                
            } catch (error) {
                updateOutput('error', `‚ùå Fallback test failed: ${error.message}`, 'error');
            }
        };
        
        // Performance analysis
        window.performanceTest = async function() {
            showLoading('performance', 'Running performance analysis...');
            
            try {
                let result = `üìä Dynamic Import Performance Analysis\n\n`;
                
                // Test multiple imports
                const modules = [
                    '/esm/math-utils.js',
                    '/esm/user-service.js',
                    '/esm/config.js'
                ];
                
                const startTime = performance.now();
                
                // Sequential loading
                console.time('Sequential Loading');
                const sequentialStart = performance.now();
                
                for (const modulePath of modules) {
                    await import(modulePath);
                }
                
                const sequentialEnd = performance.now();
                console.timeEnd('Sequential Loading');
                
                // Parallel loading
                console.time('Parallel Loading');
                const parallelStart = performance.now();
                
                await Promise.all(modules.map(path => import(path)));
                
                const parallelEnd = performance.now();
                console.timeEnd('Parallel Loading');
                
                const totalTime = performance.now() - startTime;
                
                result += `‚è±Ô∏è Loading Times:\n`;
                result += `  ‚Ä¢ Sequential: ${(sequentialEnd - sequentialStart).toFixed(2)}ms\n`;
                result += `  ‚Ä¢ Parallel: ${(parallelEnd - parallelStart).toFixed(2)}ms\n`;
                result += `  ‚Ä¢ Total test: ${totalTime.toFixed(2)}ms\n\n`;
                
                // Network analysis
                const resourceEntries = performance.getEntriesByType('resource');
                const moduleEntries = resourceEntries.filter(entry => 
                    entry.name.includes('.js') && entry.name.includes('/esm/')
                );
                
                result += `üåê Network Analysis:\n`;
                result += `  ‚Ä¢ Module requests: ${moduleEntries.length}\n`;
                moduleEntries.slice(-3).forEach(entry => {
                    const filename = entry.name.split('/').pop();
                    result += `  ‚Ä¢ ${filename}: ${entry.duration.toFixed(2)}ms\n`;
                });
                
                result += `\nüí° Performance Insights:\n`;
                
                // Calculate performance improvement safely
                const sequentialTime = sequentialEnd - sequentialStart;
                const parallelTime = parallelEnd - parallelStart;
                const improvementPercent = parallelTime > 0 ? (((sequentialTime / parallelTime) - 1) * 100).toFixed(0) : 0;
                const overheadTime = parallelTime.toFixed(0);
                
                result += `‚Ä¢ Parallel loading is ${improvementPercent}% faster\n`;
                result += `‚Ä¢ Modules are cached after first load\n`;
                result += `‚Ä¢ HTTP/2 multiplexing helps parallel requests\n`;
                result += `‚Ä¢ Dynamic imports add ~${overheadTime}ms overhead`;
                
                updateOutput('performance', result, 'success');
                
            } catch (error) {
                updateOutput('performance', `‚ùå Performance test failed: ${error.message}`, 'error');
            }
        };
        
        window.networkAnalysis = function() {
            const resourceEntries = performance.getEntriesByType('resource');
            const moduleEntries = resourceEntries.filter(entry => 
                entry.name.includes('.js') || entry.name.includes('.mjs')
            );
            
            let result = `üåê Network Analysis Report\n\n`;
            
            result += `üìä Module Loading Statistics:\n`;
            result += `  ‚Ä¢ Total JS/Module requests: ${moduleEntries.length}\n`;
            result += `  ‚Ä¢ Average load time: ${(moduleEntries.reduce((sum, entry) => sum + entry.duration, 0) / moduleEntries.length).toFixed(2)}ms\n\n`;
            
            result += `üì¶ Recent Module Requests:\n`;
            moduleEntries.slice(-5).forEach(entry => {
                const filename = entry.name.split('/').pop();
                const status = entry.responseStatus || 200;
                result += `  ‚Ä¢ ${filename}\n`;
                result += `    - Load time: ${entry.duration.toFixed(2)}ms\n`;
                result += `    - Size: ${entry.transferSize} bytes\n`;
                result += `    - Status: ${status}\n`;
            });
            
            result += `\nüîç Developer Tools Tips:\n`;
            result += `‚Ä¢ Open Network tab to see real requests\n`;
            result += `‚Ä¢ Filter by 'JS' to see only modules\n`;
            result += `‚Ä¢ Check 'Initiator' column for import chain\n`;
            result += `‚Ä¢ Look for 304 (cached) vs 200 (new) responses`;
            
            updateOutput('performance', result, 'success');
        };
        
        // Advanced patterns
        window.moduleFactory = async function() {
            showLoading('advanced', 'Implementing module factory pattern...');
            
            try {
                // Module factory function
                async function createModuleFactory(type) {
                    switch (type) {
                        case 'calculator':
                            const mathModule = await import('/esm/math-utils.js');
                            return {
                                type: 'calculator',
                                instance: new mathModule.Calculator('Factory Calculator'),
                                utilities: { add: mathModule.add, multiply: mathModule.multiply }
                            };
                            
                        case 'userManager':
                            const userModule = await import('/esm/user-service.js');
                            return {
                                type: 'userManager',
                                instance: new userModule.default(),
                                utilities: { 
                                    validateEmail: userModule.validateEmail,
                                    roles: userModule.ROLES 
                                }
                            };
                            
                        default:
                            throw new Error(`Unknown module type: ${type}`);
                    }
                }
                
                // Create multiple modules using factory
                const calculator = await createModuleFactory('calculator');
                const userManager = await createModuleFactory('userManager');
                
                updateOutput('advanced', `üè≠ Module Factory Pattern Demo

‚úÖ Factory Results:
üì± Calculator Module:
  ‚Ä¢ Type: ${calculator.type}
  ‚Ä¢ Instance: ${calculator.instance.name}
  ‚Ä¢ Test: 15 √ó 3 = ${calculator.instance.calculate('multiply', 15, 3)}

üë• User Manager Module:
  ‚Ä¢ Type: ${userManager.type}
  ‚Ä¢ Users: ${userManager.instance.getAllUsers().length}
  ‚Ä¢ Roles: ${Object.keys(userManager.utilities.roles).join(', ')}

üí° Factory Pattern Benefits:
‚Ä¢ Standardized module creation
‚Ä¢ Consistent interface across modules
‚Ä¢ Easy to extend with new types
‚Ä¢ Encapsulates module loading logic
‚Ä¢ Provides common utilities`, 'success');
                
            } catch (error) {
                updateOutput('advanced', `‚ùå Module factory failed: ${error.message}`, 'error');
            }
        };
        
        window.parallelImports = async function() {
            showLoading('advanced', 'Testing parallel import strategies...');
            
            try {
                console.time('Parallel Import Test');
                
                // Load multiple modules in parallel with Promise.all
                const [mathModule, userModule, configModule] = await Promise.all([
                    import('/esm/math-utils.js'),
                    import('/esm/user-service.js'),
                    import('/esm/config.js')
                ]);
                
                console.timeEnd('Parallel Import Test');
                
                // Test that all modules work
                const mathTest = mathModule.add(10, 20);
                const userTest = new userModule.default().getAllUsers().length;
                const configTest = configModule.getVersion();
                
                updateOutput('advanced', `‚ö° Parallel Import Results

‚úÖ All modules loaded simultaneously!

üßÆ Math Module:
  ‚Ä¢ Test: 10 + 20 = ${mathTest}
  ‚Ä¢ Exports: ${Object.keys(mathModule).length}

üë• User Module:  
  ‚Ä¢ Test: ${userTest} users available
  ‚Ä¢ Default export: ${userModule.default.name}

‚öôÔ∏è Config Module:
  ‚Ä¢ Version: ${configTest}
  ‚Ä¢ Environment: ${configModule.config.environment}

‚ö° Performance Benefits:
‚Ä¢ All modules loaded in parallel
‚Ä¢ Total time reduced vs sequential
‚Ä¢ Better user experience
‚Ä¢ Network efficiency with HTTP/2

üí° Use Cases:
‚Ä¢ Dashboard initialization
‚Ä¢ Feature bundle loading
‚Ä¢ Pre-loading related modules`, 'success');
                
            } catch (error) {
                updateOutput('advanced', `‚ùå Parallel imports failed: ${error.message}`, 'error');
            }
        };
        
        window.moduleProxy = async function() {
            showLoading('advanced', 'Creating dynamic module proxy...');
            
            try {
                // Create a proxy that loads modules on first access
                const ModuleProxy = new Proxy({}, {
                    get(target, prop) {
                        if (prop in target) {
                            return target[prop];
                        }
                        
                        // Lazy load modules based on property access
                        if (prop === 'math') {
                            target[prop] = import('/esm/math-utils.js');
                            return target[prop];
                        } else if (prop === 'user') {
                            target[prop] = import('/esm/user-service.js');
                            return target[prop];
                        } else if (prop === 'config') {
                            target[prop] = import('/esm/config.js');
                            return target[prop];
                        }
                        
                        return undefined;
                    }
                });
                
                // Use the proxy
                const mathModule = await ModuleProxy.math;
                const userModule = await ModuleProxy.user;
                
                // Test the loaded modules
                const mathResult = mathModule.add(7, 8);
                const userCount = new userModule.default().getAllUsers().length;
                
                updateOutput('advanced', `üîÆ Module Proxy Pattern Demo

‚úÖ Proxy created and tested!

üßÆ Math Module (loaded via proxy):
  ‚Ä¢ Test: 7 + 8 = ${mathResult}
  ‚Ä¢ Available: ${Object.keys(mathModule).slice(0, 3).join(', ')}...

üë• User Module (loaded via proxy):
  ‚Ä¢ Users: ${userCount}
  ‚Ä¢ Service ready: ‚úÖ

üîÆ Proxy Benefits:
‚Ä¢ Modules loaded only when accessed
‚Ä¢ Transparent loading interface  
‚Ä¢ Dynamic property handling
‚Ä¢ Memory efficient
‚Ä¢ Lazy initialization pattern

üí° Advanced Features:
‚Ä¢ Could cache loaded modules
‚Ä¢ Could implement retry logic
‚Ä¢ Could add loading indicators
‚Ä¢ Could batch related modules`, 'success');
                
            } catch (error) {
                updateOutput('advanced', `‚ùå Module proxy failed: ${error.message}`, 'error');
            }
        };
        
        // Clear output functions
        window.clearOutput = function(id) {
            const outputs = {
                'basic': 'Click "Load Math Module" to see dynamic import in action!',
                'conditional': 'Choose a feature set to load conditionally!',
                'lazy': 'Click any button to simulate lazy loading a component!',
                'error': 'Test different scenarios for dynamic import error handling!',
                'performance': 'Click "Run Performance Test" to analyze dynamic import performance!',
                'advanced': 'Explore advanced dynamic import patterns!'
            };
            
            updateOutput(id, outputs[id] || 'Ready for testing...', 'success');
        };
        
        console.log('üîÑ Dynamic imports demo ready!');
        console.log('üí° Try the different demo buttons to explore dynamic import capabilities');
    </script>
</body>
</html>
